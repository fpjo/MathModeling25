### **问题一：单枚干扰弹有效遮蔽时长计算模型**

#### **1. 问题重述 (Problem Restatement)**

本问题要求计算在给定参数条件下，由无人机FY1投放的一枚烟幕干扰弹对来袭导弹M1的有效遮蔽总时长。具体参数包括：FY1以120m/s的速度朝向假目标飞行，在受领任务1.5s后投放干扰弹，干扰弹经过3.6s后起爆。
#### **2. 模型假设 (Model Assumptions)**

为构建一个精确、可计算的数学模型，我们提出以下基本假设：

1.  **坐标系假设**：以假目标地面中心为原点(0, 0, 0)，建立三维笛卡尔右手坐标系。其中，xy平面为水平面，z轴垂直于水平面向上。
2.  **质点假设**：在宏观尺度上，将导弹、无人机、烟幕弹及烟幕云团中心均视为质点，忽略其自身尺寸、形状及旋转对运动轨迹的影响。
3.  **运动环境假设**：不考虑空气阻力、风速等环境因素对无人机、导弹及烟幕弹飞行的影响，仅考虑重力对烟幕弹的作用。
4.  **刚体假设**：真目标圆柱体的位置和形态是固定不变的。
5.  **遮蔽条件假设**：当且仅当从导弹（质点）位置发往真目标圆柱体**全部**轮廓关键点的视线均被烟幕球体遮挡时，我们判定为“有效遮蔽”。
#### **3. 符号说明 (Symbol Description)**

| 符号 (Symbol)        | 含义 (Description)  | 单位 (Unit) |
| ------------------ | ----------------- | --------- |
| $\vec{P}_m(t)$     | $t$时刻导弹M1的位置向量    | m         |
| $\vec{P}_{uav}(t)$ | $t$时刻无人机FY1的位置向量  | m         |
| $\vec{P}_g(t')$    | 烟幕弹投放后$t'$时刻的位置向量 | m         |
| $\vec{P}_c(t)$     | $t$时刻烟幕云团中心的位置向量  | m         |
| $\vec{P}_{m0}$     | 导弹M1的初始位置向量       | m         |
| $\vec{P}_{uav0}$   | 无人机FY1的初始位置向量     | m         |
| $v_m$              | 导弹飞行速度大小          | m/s       |
| $v_{uav}$          | 无人机飞行速度大小         | m/s       |
| $\vec{V}_m$        | 导弹飞行速度向量          | m/s       |
| $\vec{V}_{uav}$    | 无人机飞行速度向量         | m/s       |
| $t_{drop}$         | 干扰弹投放时刻           | s         |
| $t_{fuze}$         | 干扰弹引信时长           | s         |
| $t_{det}$          | 干扰弹起爆时刻           | s         |
| $\vec{P}_{drop}$   | 干扰弹投放点位置向量        | m         |
| $\vec{P}_{det}$    | 干扰弹起爆点位置向量        | m         |
| $R_c$              | 烟幕云团有效半径          | m         |
| $\vec{V}_s$        | 烟幕云团下沉速度向量        | m/s       |
| $T_{effect}$       | 烟幕云团有效遮蔽持续时间      | s         |
| $\vec{g}$          | 重力加速度向量           | m/s$^2$   |
| $S_T$              | 真目标圆柱体表面关键点集合     | -         |
| $T_{total}$        | 总有效遮蔽时长           | s         |

#### **4. 模型建立与求解 (Model Establishment and Solution)**

##### **4.1 运动轨迹模型**
根据运动学原理，我们可以精确描述场景中各个物体的运动轨迹。
1.  **导弹M1运动模型**：
    导弹M1从初始位置 $\vec{P}_{m0}$ 朝向原点 $O(0,0,0)$ 做匀速直线运动。其速度向量 $\vec{V}_m$ 和任意时刻 $t$ 的位置 $\vec{P}_m(t)$ 分别为：
    $$ \vec{V}_m = v_m \cdot \frac{\vec{O} - \vec{P}_{m0}}{\|\vec{O} - \vec{P}_{m0}\|} $$
    $$ \vec{P}_m(t) = \vec{P}_{m0} + \vec{V}_m \cdot t \quad (t \ge 0) $$

2.  **无人机FY1运动模型**：
    无人机FY1从初始位置 $\vec{P}_{uav0}$ 朝向假目标（原点）方向做等高度匀速直线飞行。其速度向量 $\vec{V}_{uav}$ 和任意时刻 $t$ 的位置 $\vec{P}_{uav}(t)$ 分别为：
    $$ \vec{u}_{uav} = (O_x - P_{uav0,x}, O_y - P_{uav0,y}, 0) $$
    $$ \vec{V}_{uav} = v_{uav} \cdot \frac{\vec{u}_{uav}}{\|\vec{u}_{uav}\|} $$
    $$ \vec{P}_{uav}(t) = \vec{P}_{uav0} + \vec{V}_{uav} \cdot t \quad (t \ge 0) $$

3.  **烟幕弹运动模型**：
    在 $t = t_{drop}$ 时刻，无人机在位置 $\vec{P}_{drop} = \vec{P}_{uav}(t_{drop})$ 投放烟幕弹。烟幕弹以无人机当时的速度 $\vec{V}_{uav}$ 作为初速度，仅在重力 $\vec{g}=(0,0,-9.8)$ 作用下做抛体运动。其起爆点位置 $\vec{P}_{det}$ 为：
    $$ \vec{P}_{det} = \vec{P}_{drop} + \vec{V}_{uav} \cdot t_{fuze} + \frac{1}{2}\vec{g} \cdot t_{fuze}^2 $$

4.  **烟幕云团运动模型**：
    在 $t = t_{det} = t_{drop} + t_{fuze}$ 时刻，烟幕在 $\vec{P}_{det}$ 处瞬时形成球状云团，并开始以速度 $\vec{V}_s = (0,0,-3)$ 匀速下沉。其有效作用时间窗口为 $[t_{det}, t_{det} + T_{effect}]$。在此时窗内任意时刻 $t$，烟幕云团的球心位置 $\vec{P}_c(t)$ 为：
    $$ \vec{P}_c(t) = \vec{P}_{det} + \vec{V}_s \cdot (t - t_{det}) \quad (t \in [t_{det}, t_{det} + T_{effect}]) $$

##### **4.2 遮蔽条件判据模型**

有效遮蔽的几何条件是，在同一时刻 $t$，从导弹位置 $\vec{P}_m(t)$ 到真目标上任意一点的视线，都被以 $\vec{P}_c(t)$ 为球心、 $R_c$ 为半径的烟幕球体所阻挡。

这等价于，真目标圆柱体完全位于一个以 $\vec{P}_m(t)$ 为顶点、与烟幕球体相切的“阴影锥”内部。直接判断圆柱体和圆锥体的相交关系非常复杂。因此，我们采用**关键点检测法**进行高效且精确的近似判断。我们选取真目标圆柱体轮廓上的24个关键点构成集合 $S_T$，如果所有这些关键点在时刻 $t$ 均位于阴影锥内，则判定此刻为有效遮蔽。

一个关键点 $\vec{P}_{key} \in S_T$ 位于阴影锥内的充要条件是，向量 $\vec{P}_{key} - \vec{P}_m(t)$ 与锥轴向量 $\vec{P}_c(t) - \vec{P}_m(t)$ 的夹角 $\theta$ 小于等于阴影锥的半顶角 $\alpha$。即：
$$ \theta \le \alpha \iff \cos\theta \ge \cos\alpha $$
其中，$\cos\alpha$ 可由几何关系求得：
$$ \cos\alpha(t) = \sqrt{1 - \frac{R_c^2}{\|\vec{P}_c(t) - \vec{P}_m(t)\|^2}} $$
因此，我们定义一个状态函数 $\Phi(\vec{P}_{key}, t)$：
$$ \Phi(\vec{P}_{key}, t) = \frac{(\vec{P}_{key} - \vec{P}_m(t)) \cdot (\vec{P}_c(t) - \vec{P}_m(t))}{\|\vec{P}_{key} - \vec{P}_m(t)\| \cdot \|\vec{P}_c(t) - \vec{P}_m(t)\|} - \cos\alpha(t) $$
时刻 $t$ 发生有效遮蔽的条件是，对于所有关键点 $\vec{P}_{key} \in S_T$，都有 $\Phi(\vec{P}_{key}, t) \ge 0$。这等价于：
$$ \min_{\vec{P}_{key} \in S_T} \Phi(\vec{P}_{key}, t) \ge 0 $$

##### **4.3 求解算法**

我们采用高精度数值模拟的方法求解总有效遮蔽时长。

1.  **初始化**：根据问题1给定参数，计算出常量 $\vec{V}_m, \vec{V}_{uav}, \vec{P}_{drop}, \vec{P}_{det}, t_{det}$ 以及烟幕有效时间窗口 $[T_{start}, T_{end}] = [t_{det}, t_{det} + T_{effect}]$。
2.  **定义状态函数**：定义全局遮蔽状态函数 $\Phi_{Global}(t) = \min_{\vec{P}_{key} \in S_T} \Phi(\vec{P}_{key}, t)$。
3.  **寻找状态转换点**：在时间窗口 $[T_{start}, T_{end}]$ 内，通过扫描并结合`brentq`等求根算法，精确求解出所有满足 $\Phi_{Global}(t) = 0$ 的时间点（即遮蔽状态发生改变的临界时刻）。
4.  **区间判断与时长累加**：将所有状态转换点与 $T_{start}, T_{end}$ 合并并排序，形成一系列连续的时间子区间。在每个子区间内任取一中点时刻 $t_{mid}$，判断其状态 $\Phi_{Global}(t_{mid})$ 的正负。若为正，则该子区间为有效遮蔽区间，将其时长计入总时长 $T_{total}$。
5.  **输出结果**：遍历所有子区间后，得到的 $T_{total}$ 即为问题1的最终解。